# Sentiment-aware Hybrid Recommendation System

> **"Moving beyond 'What's Popular' to 'What's Good'."**

A Final Year Project that combats "Analysis Paralysis" and misleading Star Ratings in e-commerce. This system integrates **NLP Sentiment Analysis** into a **Hybrid Recommendation Engine** to prioritize consumer trust and safety over simple sales volume (Aligned with SDG 12).

---

## Table of Contents

* [Project Overview](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#project-overview)
* [Key Features](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#key-features)
* [System Architecture](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#system-architecture)
* [Usage Guide](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#usage-guide)
* [Model Performance](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#model-performance)
* [Project Structure](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#project-structure)
* [Future Roadmap](https://github.com/khchan0123/fyp_sentiment_classification/blob/main/README.md#future-roadmap)

---

## Project Overview

Standard e-commerce recommenders rely heavily on Collaborative Filtering (User-Item interactions) and Star Ratings. However, these suffer from:

1. **Star Rating Bias:** High ratings often hide negative textual feedback.
2. **Cold Start Problem:** New users get generic, irrelevant suggestions.
3. **Trust Gap:** Users don't understand *why* an item is recommended ("Black Box" algorithms).

**This solution** builds an "Sentiment-aware Recommender" that:

* Extracts sentiment scores from text reviews using **Naïve Bayes**.
* Fuses Sentiment with User Behavior using **SVD++** (Matrix Factorization).
* Provides **Explainable AI (XAI)** insights using Google Gemini.

---

## Key Features

### 1. Hybrid Recommendation Engine 

Combines **Collaborative Filtering (SVD++)** and **Content-Based Filtering** (TF-IDF Similarity). It uses an **Augmented Rating** formula to rank items:

### 2. Explainable AI Consultant (XAI) 

An integrated "Floating Assistant" powered by **Google Gemini 2.5 Flash**. It analyzes search results in real-time to provide:

* **"The Winner":** Why the top result matches the user's intent.
* **"The Alternative":** A high-sentiment backup option.
* **Social Proof:** Specific sentiment percentages (e.g., "94% positive feedback").

### 4. Sentiment-Aware Search

A dual-strategy search engine (Regex + Vector Similarity) that visualizes "True Quality" using color-coded sentiment badges rather than just stars.

---

## System Architecture

The project follows a decoupled **Client-Server** architecture:

* **Frontend:** React.js (Context API for state management).
* **Backend:** Python Flask (REST API).
* **Data Processing:** Pandas (In-memory DataFrame handling).
* **Machine Learning:**
* *Sentiment:* Multinomial Naïve Bayes (Optimized).
* *Recommender:* SVD++ (Surprise Library).
* *Summarization:* Google Gemini API.

---

## Usage Guide

1. **Cold Start Discovery:**
* Open the homepage. Even as a new user, you will see a "Discovery Feed" generated by the Content-Based engine using metadata diversity.


2. **Smart Search:**
* Type a query (e.g., *"Iron"* or *"Gaming Mouse"*).
* Observe the **Floating AI Bubble** processing the top 8 results to generate a comparative summary.


3. **Check Safety Modal:**
* Find a product with a **Red Sentiment Badge** (<40%).
* Try to click **"Add to Cart"**.
* The system will trigger the Safety Intervention Warning.



---

## Model Performance

### Sentiment Analysis (Multinomial Naïve Bayes)

Selected for its superior recall on negative reviews compared to Deep Learning models (BERT/LSTM) on this specific dataset.
| Metric | Score | Note |
| :--- | :--- | :--- |
| **Negative Recall** | **92.59%** | Critical for safety features. |
| **Accuracy** | 96.30% | Robust classification. |
| **Macro F1** | 0.61 | Balanced performance. |

### Recommendation Engine (Hybrid SVD++)

Validated via an Ablation Study comparing Pure CF vs. Hybrid.
| Metric | Pure CF | **Hybrid (Ours)** | Improvement |
| :--- | :--- | :--- | :--- |
| **RMSE** | 1.2076 | **0.8537** | Lower error (Better Rating Prediction) |
| **Hit Rate @ 5** | 0.69% | **34.72%** | **+34% Retrieval Accuracy** |

*The Hybrid model successfully solved the "Cold Start" problem where Pure CF failed.*

---

## Project Structure

```
sentiment-hybrid-recsys/
├── backend/                  
│   ├── app.py                 # Main Flask Application
│   ├── recommender.py         # Hybrid Logic (SVD++ + Content)
│   ├── sentiment.py           # Naive Bayes Inference Engine
│   ├── models/                # Serialized Models (Output from modelling)
│   │   ├── deployed_model.bin # Final Trained Classifier
│   │   └── tfidf.pkl          # Final Vectorizer
│   ├── data/
│   │   └── amazonindia.csv    
│   └── requirements.txt
│
├── frontend/                 
│   ├── src/
│   │   ├── components/        # React Components
│   │   │   ├── ProductCard.jsx
│   │   │   ├── SafetyModal.jsx
│   │   │   └── FloatingAI.jsx
│   │   ├── services/        
│   │   └── App.js
│   └── package.json
│
├── modelling/                
│   ├── utils/
│   │   ├── dataset.py   
│   │   └── prepare_dl_data.py  
│   ├── models/             
│   │   ├── train_nb.py       
│   │   ├── train_svm.py       
│   │   ├── train_cnn.py      
│   │   └── train_cnn-lstm.py    
│   ├── amazonindia.csv
│   ├── compare_and_deploy.py     # compare models and choose the best one
│   └── eda_preprocessing.ipynb   # data understanding & preparation
└── README.md

```

---

## Future Roadmap

* **Temporal Dynamics:** Implement time-decay weighting to prioritize recent reviews over older ones.
* **Session-Based Logic:** Integrate RNNs (Recurrent Neural Networks) to personalize recommendations for guest users based on real-time clicks.
* **Advanced NLP:** Upgrade to **DistilBERT** (Knowledge Distillation) to improve nuance detection (sarcasm) without sacrificing inference speed.

---

## License

This project is licensed under the MIT License (Amazon Sales Dataset from Kaggle).

---

**Developed by [CHAN KAR HENG] | Final Year Project 2025**
